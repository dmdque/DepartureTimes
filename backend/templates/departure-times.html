<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Departure Times</title>
    <script src="frontend/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="frontend/bower_components/underscore/underscore-min.js"></script>
    <script src="frontend/bower_components/backbone/backbone-min.js"></script>
    <script src="frontend/bower_components/underscore/underscore-min.js"></script>
    <script src="https://maps.google.com/maps/api/js?sensor=false"></script>
    <link rel="stylesheet" type="text/css" href="frontend/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="frontend/styles/test.css">
</head>

<body>
<div class="container">
    <h1>Departure Times</h1>

    <!--<div>Your location is: </div>-->
    <div class="form-group">
        User custom location:<br>
        <div class="col-md-1">
            <input type="checkbox" name="custom_location" checked>
        </div>
        <div class="col-md-3">
            <input id="lat" type="number" name="latitude" class="form-control" value="37.791028"></input>
        </div>
        <div class="col-md-3">
            <input id="lon" type="number" name="longitude" class="form-control" value="-122.393375"></input>
        </div>
        <button class="btn btn-default" onclick="getDepartureTimes()">Get</button>
        <!--show only if checkbox is checked-->
        <!--googleplex-->
        <!--37.422,-122.084058-->
        <!--Toronto-->
        <!--<div class="col-md-3">-->
            <!--<input id="lat" type="number" name="latitude" class="form-control" value="43.7387793"></input>-->
        <!--</div>-->
        <!--<div class="col-md-3">-->
            <!--<input id="lon" type="number" name="longitude" class="form-control" value="-79.3138695"></input>-->
        <!--</div>-->
    </div>

    <div class="row">
        <div class="col-md-12">
            <div id="test"></div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div id="mapholder"></div>
        </div>
    </div>
    <div id="closest_busses"></div>
    <div id="closest_bus_stops"></div>
    <div id="demo"></div>

<script type="text/template" id="busStop-template">
<div class="view">
    <div>The bus name is <%= title %></div>
    <% _.each(predictions, function(prediction) { %>
        <div>Departure: <%= Math.trunc(prediction.seconds / 60) %>:<%= prediction.seconds % 60%></div>
    <% }) %>
</script>

<script type="text/template" id="busStops-template">
<div class="bus-stops-collection-view"></div>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>#</th>
                <th>Bus Title</th>
                <th>Route</th>
                <th>Direction</th>
                <th>Prediction</th>
            </tr>
        </thead>
        <tbody>
            <% _.each(collection, function(model) { %>
                <tr>
                    <td><%= model.stopTag %></td>
                    <td><%= model.title %></td>
                    <td><%= model.routeTag %></td>
                    <td><%= model.direction %></td>

                    <td>
                    <% var comma_flag = false %>
                    <% _.each(model.predictions, function(prediction) { %>
                        <% if (comma_flag) { %>
                            <span>, </span>
                        <% } else { %>
                            <% comma_flag = true %>
                        <% } %>
                        <% if (prediction.seconds === undefined) { %>
                            <span>There are no predictions for this bus stop.</span>
                        <% } else { %>
                            <%= Math.trunc(prediction.seconds / 60) %>:<%= prediction.seconds % 60 %>
                        <% } %>
                    <% }); %>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>
</script>

<script src="frontend/scripts/main.js"></script>
<script src="frontend/scripts/models/busStop.js"></script>
<script src="frontend/scripts/views/busStop.js"></script>
<script src="frontend/scripts/collections/busStops.js"></script>
<script src="frontend/scripts/views/busStops.js"></script>
<script src="frontend/test.js"></script>
</body>
</html>
